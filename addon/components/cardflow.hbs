<div class="cardflow">
  <header class="cardflow__header">
    <div>
      <div class="cardflow__project-title">{{this.project.projectTitle}}</div>
      <div class="cardflow__title">{{or this.project.description this.project.title}}</div>
    </div>
    <LinkTo @route="media-registry" @model={{@model.id}} @class="mode-indicator mode-indicator--workflow">
      Workflow mode
    </LinkTo>
  </header>

  {{!-- Main Thread --}}
  <div class="cardflow__thread">
    {{!-- Date line --}}
    <div class="cardflow__message-divider">
      <div class="cardflow__message-divider-border" />
      <div class="cardflow__message-divider-date">August 31, 2020</div>
    </div>

    {{!-- Message --}}
    <div class="cardflow__message">
      {{!-- Sender --}}
      <div class="cardflow__message-row">
        <div class="cardflow__message-icon" style={{css-url "background-image" "/media-registry/profiles/Lisa-Track.jpg"}}></div>
        <div class="cardflow__message-sender">
          <span class="cardflow__message-sender-name">Lisa Track</span> <time>2:49 PM</time>
          <div>Administrator</div>
        </div>
      </div>
      {{!-- Content --}}
      <div class="cardflow__message-row">
        <div />
        <div class="cardflow__message-content">
          <div>Hi Steve, As discussed, we are transferring the rights to 13 of Pia Midina’s and 3 of BB Clarke’s recordings to CRD Records. Best regards, Lisa</div>
          {{!-- TODO: 1- Transfer Proposal CARD --}}
          <CardPlatter @class="flow-agreement-card">
            <header>
              <div class="flow-agreement-card__title">Transfer Proposal</div>
              {{!-- <div>Aug 31, 2020</div> --}}
            </header>
            <div class="flow-agreement-card__people">
              <div>
                <div class="field-renderer__title agreement-card__field-title">From</div>
                <div class="flow-agreement-card__participant">
                  {{svg-jar "button-bunny-records" width="40px" height="40px"}}
                  <div class="cardflow__participant-company">Bunny Records</div>
                </div>
              </div>
              <div>
                <div class="field-renderer__title agreement-card__field-title">To</div>
                <div class="flow-agreement-card__participant">
                  {{svg-jar "button-crd-records" width="40px" height="40px"}}
                  <div>CRD Records</div>
                </div>
              </div>
            </div>
            <div>
              <div class="field-renderer__title agreement-card__field-title">Catalog</div>
              {{component (or this.catalog.component "card") model=this.catalog.value mode="view" variant="small"}}
              <div class="media-collection__pill flow-agreement-card__btn">Inspect Catalog</div>
            </div>
            <footer>
              Effective Date: <strong>September 1, 2020</strong>
            </footer>

            {{#if (eq @model.id "crd_records")}}
              {{!-- TODO:
              Transfer Accepted
              September 1, 8:11 AM 2020
              --}}
            {{/if}}
          </CardPlatter>
        </div>
      </div>
    </div>

    {{#if (eq @model.id "bunny_records")}}
      {{!-- TODO: 2- Reply to Steve --}}

      {{!-- TODO: 3- Next Steps for Lisa --}}
      <div class="cardflow__message">
        <div class="cardflow__message-row">
          <div />
          <CardPlatter @class="next-steps">
            <div>
              <div class="next-steps__title">Next Steps</div>
              <div class="next-steps__text">Visible only to you</div>
            </div>

            <div class="breadcrumbs__pill breadcrumbs__pill--current">Send Email Reminder</div>
          </CardPlatter>
        </div>
      </div>
      <div class="cardflow__message"></div>
    {{/if}}

    {{#if (eq @model.id "crd_records")}}
      {{!-- TODO: Steve Rights joined the thread  2:56 PM --}}

      <div class="cardflow__message-divider">
        <div class="cardflow__message-divider-border" />
        <div class="cardflow__message-divider-date">September 1, 2020</div>
      </div>

      {{!-- TODO: Steve Rights accepted the transfer  8:11 AM  Jump --}}

      {{!-- TODO: 4- Amended Metadata CARD --}}

      {{!-- TODO: Added to CRD Records Catalog 8:13 AM --}}
      {{!-- TODO: 5- CARD --}}

      {{!-- TODO: Published to Verifi Public Registry 8:18 AM --}}
      {{!-- TODO: 6- CARD --}}

      {{!-- TODO: 2- Reply to Lisa --}}

      {{!-- TODO: 3- Next Steps --}}
    {{/if}}
  </div>

{{!-- Right Sidebar --}}
  <aside class="cardflow__sidebar">
    {{!-- Progress Pie --}}
    <section class="cardflow__sidebar-section">
      <h3 class="cardflow__sidebar-title">Progress</h3>
      <div class="cardflow__progress">
        <div class="cardflow__progress-icon" style={{css-url "background-image" this.progress.iconLg}}>
          <span class="cardflow__progress-pct">{{this.progress.pct}}%</span>
        </div>
        <div class="cardflow__progress-status">{{this.progress.desc}}</div>
      </div>
    </section>

    {{!-- Checklist --}}
    <section class="cardflow__sidebar-section">
      <h3 class="cardflow__sidebar-title">Checklist</h3>
      <CardPlatter>
        {{#let this.progress.pct as |progress|}}
          <ul class="cardflow__checklist">
            <li class="cardflow__checklist-item {{if (gt progress 0) "completed" (if (eq progress 0) "current")}}">
                {{svg-jar (if (gt progress 0) "checkmark-lg" "checklist-circle") width="16px" height="16px"}} Propose
                {{#if (gt progress 0)}}<span class="cardflow__checklist-time">1d ago</span>{{/if}}
            </li>
            <li class="cardflow__checklist-item {{if (gt progress 20) "completed" (if (eq progress 20) "current")}}">
              {{svg-jar (if (gt progress 20) "checkmark-lg" "checklist-circle") width="16px" height="16px"}} Review
              {{#if (gt progress 20)}}<span class="cardflow__checklist-time">1d ago</span>{{/if}}
            </li>
            <li class="cardflow__checklist-item {{if (gt progress 40) "completed" (if (eq progress 40) "current")}}">
              {{svg-jar (if (gt progress 40) "checkmark-lg" "checklist-circle") width="16px" height="16px"}} Accept
              {{#if (gt progress 40)}}<span class="cardflow__checklist-time">10m ago</span>{{/if}}
            </li>
            <li class="cardflow__checklist-item {{if (gt progress 60) "completed" (if (eq progress 60) "current")}}">
              {{svg-jar (if (gt progress 60) "checkmark-lg" "checklist-circle") width="16px" height="16px"}} Amend
              {{#if (gt progress 60)}}<span class="cardflow__checklist-time">5m ago</span>{{/if}}
            </li>
            <li class="cardflow__checklist-item {{if (gt progress 80) "completed" (if (eq progress 80) "current")}}">
              {{svg-jar (if (gt progress 80) "checkmark-lg" "checklist-circle") width="16px" height="16px"}} Redeliver
              {{#if (gt progress 80)}}<span class="cardflow__checklist-time">1m ago</span>{{/if}}
            </li>
          </ul>
        {{/let}}
      </CardPlatter>
    </section>

    {{!-- Participants Box --}}
    <section class="cardflow__sidebar-section">
      <h3 class="cardflow__sidebar-title">Participants</h3>
      <CardPlatter>
        {{#each @model.orgs as |participant|}}
          <div class="cardflow__participants">
            <div class="cardflow__participant">
              <div class="cardflow__participant-company-img" style={{css-url "background-image" participant.iconURL}} />
              <div class="cardflow__participant-company">{{participant.company}}</div>
            </div>
            <div class="cardflow__participant">
              <div class="cardflow__participant-user-img" style={{css-url "background-image" participant.user.imgURL}} />
              <div class="cardflow__participant-user">
                {{participant.user.name}}<br>
                <span>{{participant.user.title}}</span>
              </div>
            </div>
          </div>
        {{/each}}
      </CardPlatter>
    </section>
  </aside>
</div>