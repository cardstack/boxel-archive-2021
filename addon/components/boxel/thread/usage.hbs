<Freestyle::Usage @name="Thread">
  <:example>
    <button {{on "click" this.addMessage}}>Add a message</button>
    <Boxel::Thread
      @autoscroll={{this.autoscroll}}
      @lastElement={{this.lastMessage}}
      @onThreadContentChanged={{this.onThreadContentChanged}}
      class="boxel-thread-usage"
    >
      <:header>
        <Boxel::ThreadHeader @title="Project Title" />
      </:header>

      <:content>
        <Boxel::DateDivider @date={{dayjs-format (now)}} />
        {{#each this.messages}}
          <Boxel::ThreadMessage
            @name="Cardbot"
            @hideName={{true}}
            @imgURL={{this.cardBotIcon}}
          >
            Hello, it's nice to see you!
          </Boxel::ThreadMessage>
        {{/each}}
      </:content>
      <:footer>
        <div class="boxel-thread-usage-footer">
          You're viewing older messages!
        </div>
      </:footer>
    </Boxel::Thread>
  </:example>

  <:api as |Args|>
  <Args.Bool
    @name="autoscroll"
    @description="Whether to automatically scroll down to newly added elements if the user is close enough to the end of the thread (see the autoscroll modifier)."
    @default={{false}}
    @value={{this.autoscroll}}
    @onInput={{fn (mut this.autoscroll)}}
  />
  <Args.Object
    @name="lastElement"
    @description="The last html element in the thread; the component checks whether it is visible within its scrollable area and shows the footer if not."
    @optional={{true}}
  />
  <Args.Action
    @name="onThreadContentChanged"
    @description="A callback called whenever the children of the <content> named block are added or removed. The callback is called with the thread component's root element as the argument."
    @optional={{true}}
  />
  <Args.Yield
    @name="header"
    @description="Named block for the header"
  />
  <Args.Yield
    @name="content"
    @description="Named block for thread messages/content"
  />
  <Args.Yield
    @name="sidebar"
    @description="Named block for a sidebar shown on the right of the thread messages"
  />
  <Args.Yield
    @name="taskbar"
    @description="Named block for a taskbar that is placed at the top of the thread and is positioned stickily."
  />
  <Args.Yield
    @name="footer"
    @description="Named block for a footer that is shown when the `lastElement` is no longer visible"
  />
  </:api>
</Freestyle::Usage>


<Freestyle::Usage @slug="Thread-with-workflow">
  <:example>
    <Boxel::Thread>
      <:header>
        <Boxel::ThreadHeader @title="Project Title" />
      </:header>

      <:content>
        <Boxel::DateDivider @date={{dayjs-format (now)}} />
        <Boxel::ThreadMessage
          @name="Cardbot"
          @hideName={{true}}
          @imgURL={{this.milestones.0.senderIcon}}
        >
          {{this.milestones.0.message}}
        </Boxel::ThreadMessage>
      </:content>

      <:sidebar as |SidebarSection|>
        <SidebarSection>
          <Boxel::Sidebar::CardContainer
            @header="Workflow: Project Title"
            @attachNext={{true}}
          >
            <div>
              <Boxel::ProgressCircle
                @percentComplete={{percent-complete total=this.milestones.length completed=0}}
              />
            </div>
            <div>
              Workflow started
            </div>
          </Boxel::Sidebar::CardContainer>

          <Boxel::Sidebar::CardContainer @header="Milestones">
            <Boxel::ProgressSteps
              @progressSteps={{this.milestones}}
              @completedCount={{0}}
            />
          </Boxel::Sidebar::CardContainer>
        </SidebarSection>

        <SidebarSection>
          <Boxel::HelpBox />
        </SidebarSection>

        <SidebarSection>
          <Boxel::Sidebar::CardContainer
            @header="Participants"
            @attachNext={{true}}
          >
            <Boxel::ParticipantList
              @fullWidth={{true}}
              @participants={{this.userGroup}}
            />
          </Boxel::Sidebar::CardContainer>

          <Boxel::Sidebar::CardContainer>
            <Boxel::ParticipantList
              @fullWidth={{true}}
              @participants={{this.orgGroup}}
            />
            <Boxel::AddParticipantButton
              {{on "click" (optional @addParticipant)}}
            />
          </Boxel::Sidebar::CardContainer>
        </SidebarSection>
      </:sidebar>
    </Boxel::Thread>
  </:example>
</Freestyle::Usage>
