<EmberTable @class="media-collection-table media-collection-table--{{@type}} media-collection-table--{{@mode}}" as |t|>
  <t.head
    @columns={{@columns}}
    @onUpdateSorts={{@onUpdateSorts}}
    @class="media-collection-table__header" as |h|>

    <h.row as |r|>
      <r.cell as |column|>
        <span class="media-collection-table__header-cell {{if (eq @sortColumn.valuePath column.valuePath) "is-sorting"}}">
          {{column.name}}
          {{#if (eq @sortColumn.valuePath column.valuePath)}}
            <div class="media-collection-table__sort-arrow {{if (eq @sortDirection "asc") "ascending"}}">
              {{svg-jar "arrow-down" width="10px" height="10px"}}
            </div>
          {{/if}}
        </span>
      </r.cell>
    </h.row>

  </t.head>
  <t.body
    @rows={{@collection}}
    @estimateRowHeight={{60}}
    @class="media-collection-table__body" as |b|
  >

    <b.row class={{if b.rowValue.selected "is-selected"}} as |r|>
      <r.cell as |cell column row cellMeta columnMeta|>
        <Boxel class="media-collection-table__boxel-cell">
          <BoxelHighlight {{on "click" (fn this.selectOrTransition row)}} @on={{row.selected}} @class="media-collection-table__highlight" />
          {{#if (and (eq (add columnMeta.index 1) b.cells.length) (eq @mode "edit"))}}
            <BoxelActions
              @class="media-collection-table__actions-btns"
              @displayHighlightActions={{row.selected}}
              @btnLeft="more-actions"
              @btnLeftIcon="more-actions"
              @btnRightIcon="expand"
              @btnRightAction={{fn this.selectOrTransition row}}
            />
          {{/if}}
          <div class="media-collection-table__cell {{if (eq columnMeta.index 0) "media-collection-table__cell--first-col"}} {{if row.selected "row-group-selected"}} media-collection-table__cell--{{@mode}}">
            {{#if (eq columnMeta.index 0)}}
              <SelectButton
                {{on "click" (fn this.toggleSelect row)}}
                @mode={{@mode}}
                @isSelected={{row.selected}}
                @class="media-collection-table__select-btn media-collection-table__select-btn--{{@mode}} {{if row.selected "media-collection-table__select-btn--selected"}}"
              />
              {{#if (not-eq @type "master-collection")}}
                <button class="media-collection-table__play-btn">
                  {{svg-jar "play-btn-sm" width="30px" height="30px"}}
                </button>
              {{/if}}
            {{/if}}
            <div class="media-collection-table__cell-value {{if (eq columnMeta.index 0) "media-collection-table__cell-value--first-col"}} {{if (eq column.valuePath "cover_art") "media-collection-table__cell-value--img"}}">
              {{#if (and (eq (add columnMeta.index 1) b.cells.length) (eq @mode "edit"))}}
                <button {{on "click" (fn @removeItem row)}} class="media-collection-editor__remove-btn" aria-label="remove">{{svg-jar "icon-minus-circle" width="16px" height="16px"}}</button>
              {{else if (eq column.valuePath "cover_art")}}
                <div class="media-collection-table__img-cell" style={{css-url "background-image" row.cover_art_thumb}} />
              {{else if (eq column.valuePath "top_artists")}}
                {{#each cell as |c|}}
                  {{c}}<br>
                {{/each}}
              {{else if (contains column.valuePath this.dateFields)}}
                {{moment-format cell "MMM DD, YYYY" "YYYY-MM-DD"}}
              {{else if (contains column.valuePath this.titleCaseFields)}}
                {{titleize cell}}
              {{else}}
                {{cell}}
              {{/if}}
            </div>
          </div>
        </Boxel>
      </r.cell>
    </b.row>
  </t.body>
</EmberTable>